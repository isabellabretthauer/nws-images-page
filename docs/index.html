<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>üå§Ô∏è NWS Daily Weather Maps & Radar</title>

  <!-- Weather Icons -->
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/weather-icons/2.0.10/css/weather-icons.min.css">
  <!-- Font Awesome for wave & flag icons -->
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">

  <style>
    body {
      background: #f0f8ff;
      font-family: "Segoe UI", sans-serif;
      color: #333;
      text-align: center;
      padding: 2rem 1rem;
    }
    h1 { margin: 0; font-size: 2rem; color: #0277bd; }
    h2.subtitle { margin: .2rem 0 1.5rem; font-size: 1.2rem; color: #555; font-style: italic; }

    /* ‚Äî‚Äî Current Weather Styles ‚Äî‚Äî */
    #weather-summary {
      max-width: 800px; margin: 1.5rem auto; padding: 1.5rem;
      background: #81d4fa; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      color: #fff;
    }
    #weather-summary h2 { margin: 0 0 .2rem 0; font-size: 1.6rem; color: #0d47a1; }
    #weather-summary h3.date { margin: .1rem 0 .8rem; font-size: 1rem; color: rgba(255,255,255,0.85); font-style: italic; }
    .weather-card {
      display: grid; grid-template-columns: repeat(5,1fr); gap:1rem; margin-top:1rem;
    }
    .weather-item {
      background: rgba(0,0,0,0.4); border-radius:6px; padding:1rem; text-align:center;
    }
    .weather-item i { font-size:2rem; display:block; margin-bottom:.3rem; color:#ffd54f; }
    .weather-item .label { display:block; font-size:.8rem; opacity:.8; }
    .weather-item .value { font-size:1rem; font-weight:bold; }
    .weather-item .subvalue { display:block; font-size:.7rem; opacity:.7; margin-top:.5rem; }

    /* ‚Äî‚Äî Surf Forecast Styles ‚Äî‚Äî */
    #surf-forecast {
      max-width:800px; margin:1.5rem auto; padding:1rem;
      background:#ffffffcc; border-radius:8px; box-shadow:0 4px 12px rgba(0,0,0,0.1);
      text-align:left; color:#333;
    }
    #surf-forecast h2 { margin:0 0 .2rem 0; font-size:1.4rem; color:#0277bd; }
    #surf-forecast h3.subsubtitle { margin:.1rem 0 .6rem; font-size:1rem; color:#555; font-style:italic; }
    .surf-item {
      display:flex; align-items:center; margin:.5rem 0; font-size:.9rem;
    }
    .surf-item i { font-size:1rem; margin-right:.5rem; color:#0277bd; }
    .surf-item i.flag { /* color set dynamically via JS */ }
    .surf-item .label { font-weight:bold; margin-right:.5rem; }
    .surf-item .value { margin-right:.5rem; }

    /* ‚Äî‚Äî Rip Current Flag Guide ‚Äî‚Äî */
    #flag-guide {
      max-width:800px; margin:1.5rem auto; padding:1rem;
      background:#ffffffcc; border-radius:8px; box-shadow:0 4px 12px rgba(0,0,0,0.1);
      text-align:left; color:#333;
    }
    #flag-guide h2 { margin-top:0; font-size:1.4rem; color:#0277bd; }
    #flag-guide p { margin:.5rem 0; font-size:.9rem; }

    /* ‚Äî‚Äî Slideshow Styles ‚Äî‚Äî */
    .slideshow {
      position:relative; max-width:800px; margin:2rem auto;
      border:4px solid #81d4fa; border-radius:12px; overflow:hidden;
      box-shadow:0 6px 18px rgba(0,0,0,0.15); background:white; height:450px;
    }
    .slideshow img {
      position:absolute; top:0; left:0; width:100%; height:100%;
      object-fit:contain; opacity:0; transition:opacity 1s ease-in-out;
    }
    .slideshow img.active { opacity:1; z-index:1; }

    /* ‚Äî‚Äî Footer Caption ‚Äî‚Äî */
    #data-caption { font-size:.8rem; color:#666; margin-top:1.5rem; }
  </style>
</head>
<body>
  <h1>‚òÄÔ∏è Daily Weather Forecast</h1>
  <h2 class="subtitle">Melbourne, FL</h2>

  <!-- ‚Äî‚Äî Current Weather ‚Äî‚Äî -->
  <section id="weather-summary">
    <h2>Current Weather</h2>
    <h3 class="date">Date: <span id="current-date">--/--/----</span></h3>
    <div class="weather-card">
      <div class="weather-item">
        <i class="wi wi-thermometer"></i>
        <span class="label">Temp</span>
        <span class="value" id="w-temp">--¬∞F</span>
        <span class="subvalue">Max: <span id="w-max">--¬∞F</span></span>
        <span class="subvalue">Min: <span id="w-min">--¬∞F</span></span>
      </div>
      <div class="weather-item">
        <i class="wi wi-humidity"></i>
        <span class="label">Humidity</span>
        <span class="value" id="w-hum">--%</span>
      </div>
      <div class="weather-item">
        <i class="wi wi-rain"></i>
        <span class="label">Rain</span>
        <span class="value" id="w-rain">--%</span>
      </div>
      <div class="weather-item">
        <i class="wi wi-strong-wind"></i>
        <span class="label">Wind</span>
        <span class="value" id="w-wind">--</span>
      </div>
      <div class="weather-item">
        <i class="wi wi-day-sunny"></i>
        <span class="label">Forecast</span>
        <span class="value" id="w-forecast">Loading‚Ä¶</span>
      </div>
    </div>
  </section>

  <!-- ‚Äî‚Äî Surf Forecast ‚Äî‚Äî -->
  <section id="surf-forecast">
    <h2>Surf Forecast</h2>
    <h3 class="subsubtitle">Melbourne Beach</h3>
    <div class="surf-item">
    <i class="fas fa-water"></i>
      <span class="label">Rip Current Risk:</span>
      <span class="value" id="s-risk">--</span>
      <span id="s-flag" class="flag"></span>
    </div>
    <div class="surf-item">
      <i class="wi wi-tsunami"></i>
      <span class="label">Surf Height:</span>
      <span class="value" id="s-height">--</span>
    </div>
    <div class="surf-item">
      <i class="wi wi-storm-showers"></i>
      <span class="label">Thunderstorm Potential:</span>
      <span class="value" id="s-thunder">--</span>
    </div>
    <div class="surf-item">
      <i class="wi wi-day-sunny"></i>
      <span class="label">UV Index:</span>
      <span class="value" id="s-uv">Very High</span>
    </div>
    <div class="surf-item">
      <i class="wi wi-sunrise"></i>
      <span class="label">Sunrise:</span>
      <span class="value" id="s-sunrise">--:--</span>
    </div>
    <div class="surf-item">
      <i class="wi wi-sunset"></i>
      <span class="label">Sunset:</span>
      <span class="value" id="s-sunset">--:--</span>
    </div>
  </section>

  <!-- ‚Äî‚Äî Rip Current Flag Guide ‚Äî‚Äî -->
  <section id="flag-guide">
    <h2>Rip Current Flag Guide</h2>
    <p><span style="color:#00FF00;"><i class="fas fa-flag"></i></span> <strong>Green Flag</strong> ‚Äì Low Risk: Rip currents unlikely.</p>
    <p><span style="color:#FFFF00;"><i class="fas fa-flag"></i></span> <strong>Yellow Flag</strong> ‚Äì Moderate Risk: Dangerous currents possible.</p>
    <p><span style="color:#FF0000;"><i class="fas fa-flag"></i></span> <strong>Red Flag</strong> ‚Äì High Risk: Life-threatening currents; swim not recommended.</p>
    <p>
      <span style="color:#FF0000;"><i class="fas fa-flag"></i></span>
      <span style="color:#FF0000;"><i class="fas fa-flag"></i></span>
      <strong>Double Red Flag</strong> ‚Äì Extreme Hazard: Water closed to public.
    </p>
    <p><span style="color:purple;"><i class="fas fa-flag"></i></span> <strong>Purple Flag</strong> ‚Äì Marine Hazards: Dangerous marine life or water quality issues.</p>
  </section>

  <!-- ‚Äî‚Äî Slideshow ‚Äî‚Äî -->
  <div class="slideshow"></div>

  <!-- ‚Äî‚Äî Scripts ‚Äî‚Äî -->
  <script>
    // set today's date
    document.addEventListener('DOMContentLoaded', () => {
      const now = new Date();
      document.getElementById('current-date').textContent =
        `${now.getMonth()+1}/${now.getDate()}/${now.getFullYear()}`;
    });

    fetch('melbourne_fl_summary.txt')
      .then(r => r.ok ? r.text() : Promise.reject('Load failed'))
      .then(txt => {
        const L = txt.split('\n');

        // Current conditions
        const curr = L.find(l => l.startsWith('Temp:'));
        const tM = curr.match(/Temp: ([\d.]+)¬∞F/),
              hM = curr.match(/Humidity: ([\d.]+)%/);

        // Forecast
        const todayLine   = L.find(l => l.startsWith('‚Ä¢ Today:'));
        const tonightLine = L.find(l => l.startsWith('‚Ä¢ Tonight:'));
        const rainM = todayLine.match(/Rain: (\d+)%/),
              windM = todayLine.match(/Wind: ([^;]+)/),
              foreM = todayLine.match(/‚Äî\s*([^.;]+)/),
              maxM  = todayLine.match(/High: (\d+)¬∞F/),
              minM  = tonightLine.match(/Low: (\d+)¬∞F/);

        // Surf block
        const startIdx = L.findIndex(l => l.startsWith('Southern Brevard Barrier Islands'));
        const endIdx   = L.findIndex((l,i) => i > startIdx && l.includes('Sunset'));
        const block    = L.slice(startIdx, endIdx + 1);

        const ripLine  = block.find(l => l.startsWith('Rip Current Risk')),
              surfLine = block.find(l => l.startsWith('Surf Height')),
              thunLine = block.find(l => l.includes('Thunderstorm Potential')),
              srLine   = block.find(l => l.trim().startsWith('Sunrise')),
              ssLine   = block.find(l => l.trim().startsWith('Sunset'));

        const ripM2  = ripLine.match(/Rip Current Risk.*?([A-Za-z]+)/),
              surfM  = surfLine.match(/Around\s*([\d\s\w]+)/),
              thunM  = thunLine.match(/Thunderstorm Potential.*?([A-Za-z]+)/),
              srM2   = srLine.match(/Sunrise.*?(\d{1,2}:\d{2}\s?(?:AM|PM))/),
              ssM2   = ssLine.match(/Sunset.*?(\d{1,2}:\d{2}\s?(?:AM|PM))/);

        const thunderMap = { Low:'Low chance', Moderate:'Moderate chance', High:'Very likely' },
              colorMap   = { Low:'#00FF00', Moderate:'#FFFF00', High:'#FF0000' };

        // inject current
        if (tM)   document.getElementById('w-temp').textContent     = tM[1]+'¬∞F';
        if (hM)   document.getElementById('w-hum').textContent      = hM[1]+'%';
        if (rainM)document.getElementById('w-rain').textContent    = rainM[1]+'%';
        if (windM)document.getElementById('w-wind').textContent    = windM[1].trim();
        if (foreM){
          let txt = foreM[1].trim() + '.';
          txt = txt.replace(/^Chance\s+/, 'Chance of ');
          document.getElementById('w-forecast').textContent = txt;
        }
        if (maxM) document.getElementById('w-max').textContent     = maxM[1]+'¬∞F';
        if (minM) document.getElementById('w-min').textContent     = minM[1]+'¬∞F';

        // inject surf
        if (ripM2) {
          document.getElementById('s-risk').textContent  = ripM2[1];
          document.getElementById('s-flag').style.color  = colorMap[ripM2[1]] || '#ccc';
        }
        if (surfM) document.getElementById('s-height').textContent  = surfM[1].trim();
        if (thunM) document.getElementById('s-thunder').textContent= thunderMap[thunM[1]]||thunM[1];
        document.getElementById('s-uv').textContent               = 'Very High';
        if (srM2)  document.getElementById('s-sunrise').textContent= srM2[1];
        if (ssM2)  document.getElementById('s-sunset').textContent = ssM2[1];
      })
      .catch(console.error);
  </script>

  <!-- ‚Äî‚Äî Slideshow Script ‚Äî‚Äî -->
  <script>
    (function(){
      const files     = ['1.png','2.png','5.png','6.png','7.png','Climate.png','Forecast.png','KMLB_loop.gif'],
            base      = 'images/',
            container = document.querySelector('.slideshow'),
            slides    = [];
      let idx=0, started=false;
      files.forEach(name=>{
        const img = new Image();
        img.src = base + name;
        img.onload = ()=>{
          img.classList.add('slide');
          container.appendChild(img);
          slides.push(img);
          if (!started) {
            started = true;
            slides[0].classList.add('active');
            setInterval(()=>{
              slides[idx].classList.remove('active');
              idx = (idx+1)%slides.length;
              slides[idx].classList.add('active');
            },10000);
          }
        };
      });
    })();
  </script>

  <div id="data-caption">
    Data extracted from the National Weather Service (NWS).
  </div>
</body>
</html>
