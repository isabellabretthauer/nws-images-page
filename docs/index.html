<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>üå§Ô∏è NWS Daily Weather Maps & Radar</title>

  <!-- Weather Icons -->
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/weather-icons/2.0.10/css/weather-icons.min.css">

  <style>
    /* ‚Ä¶ your existing CSS from the baseline version ‚Ä¶ */
  </style>
</head>
<body>
  <h1>‚òÄÔ∏è Daily Weather Forecast</h1>
  <h2 class="subtitle">Melbourne, FL</h2>

  <!-- Weather Summary -->
  <section id="weather-summary">
    <h2>Current Weather</h2>
    <!-- ‚Ä¶ your five weather-item cards ‚Ä¶ -->
  </section>

  <!-- Surf Forecast -->
  <section id="surf-forecast">
    <h2>Surf Forecast</h2>
    <!-- Rip Current Risk -->
    <div class="surf-item">
      <i class="wi wi-flag"></i>
      <span class="label">Rip Current Risk:</span>
      <span class="value" id="s-risk">--</span>
      <span id="s-flag" class="flag"></span>
    </div>
    <!-- Surf Height -->
    <div class="surf-item">
      <i class="wi wi-surfing"></i>
      <span class="label">Surf Height:</span>
      <span class="value" id="s-height">--</span>
    </div>
    <!-- Thunderstorm Potential -->
    <div class="surf-item">
      <i class="wi wi-storm-showers"></i>
      <span class="label">Thunderstorm Potential:</span>
      <span class="value" id="s-thunder">--</span>
    </div>
    <!-- Water Temperature -->
    <div class="surf-item">
      <i class="wi wi-thermometer-exterior"></i>
      <span class="label">Water Temperature:</span>
      <span class="value" id="s-water-temperature">--</span>
    </div>
    <!-- UV Index -->
    <div class="surf-item">
      <i class="wi wi-day-sunny"></i>
      <span class="label">UV Index:</span>
      <span class="value" id="s-uv">--</span>
    </div>
    <!-- Sunrise -->
    <div class="surf-item">
      <i class="wi wi-sunrise"></i>
      <span class="label">Sunrise:</span>
      <span class="value" id="s-sunrise">--:--</span>
    </div>
    <!-- Sunset -->
    <div class="surf-item">
      <i class="wi wi-sunset"></i>
      <span class="label">Sunset:</span>
      <span class="value" id="s-sunset">--:--</span>
    </div>
  </section>

  <!-- Slideshow -->
  <div class="slideshow"></div>

  <script>
  fetch('melbourne_fl_summary.txt')
    .then(r => r.ok ? r.text() : Promise.reject('Failed to load'))
    .then(txt => {
      const lines = txt.split('\n');

      // ‚Äî Current Conditions (unchanged) ‚Äî
      // ‚Ä¶ your existing temp/humidity/forecast parsing ‚Ä¶

      // ‚Äî Surf block extraction (unchanged) ‚Äî
      const surfStart = lines.findIndex(l => l.startsWith('Southern Brevard Barrier Islands'));
      const surfEnd   = lines.findIndex((l,i) => i > surfStart && l.includes('Sunset'));
      const surfBlock = lines.slice(surfStart, surfEnd + 1);

      // find each line
      const riskLine    = surfBlock.find(l => l.startsWith('Rip Current Risk'));
      const heightLine  = surfBlock.find(l => l.startsWith('Surf Height'));
      const thunderLine = surfBlock.find(l => l.includes('Thunderstorm Potential'));
      const waterLine   = surfBlock.find(l => l.trim().toLowerCase().startsWith('water temperature'));
      const uvLine      = surfBlock.find(l => l.startsWith('UV Index'));
      const srLine      = surfBlock.find(l => l.trim().startsWith('Sunrise'));
      const ssLine      = surfBlock.find(l => l.trim().startsWith('Sunset'));

      // regex pulls
      const riskMatch    = riskLine.match(/Rip Current Risk.*?([A-Za-z]+)/);
      const heightMatch  = heightLine.match(/Around\s*([\d\s\w]+)/);
      const thunderMatch = thunderLine.match(/Thunderstorm Potential.*?([A-Za-z]+)/);
      const uvMatch      = uvLine.match(/UV Index.*?([A-Za-z]+)/);
      const srMatch      = srLine.match(/Sunrise.*?(\d{1,2}:\d{2}\s?(?:AM|PM))/);
      const ssMatch      = ssLine.match(/Sunset.*?(\d{1,2}:\d{2}\s?(?:AM|PM))/);

      // ‚Äî NEW: water temperature fallback logic ‚Äî
      let waterTemp = '--';
      if (waterLine) {
        // try to capture digits
        const mNum = waterLine.match(/Water Temperature.*?([\d.]+)/i);
        if (mNum) {
          waterTemp = mNum[1] + '¬∞F';
        } else {
          // otherwise take everything after the dots
          const parts = waterLine.split(/\.{2,}/);
          if (parts[1]) {
            waterTemp = parts[1].trim().replace(/\.$/, '');
          }
        }
      }

      const colorMap = { Low: '#00FF00', Moderate: '#FFFF00', High: '#FF0000' };

      // ‚Äî Inject back into DOM ‚Äî
      if (riskMatch)    { document.getElementById('s-risk').textContent = riskMatch[1];
                          document.getElementById('s-flag').style.background = colorMap[riskMatch[1]]; }
      if (heightMatch)  document.getElementById('s-height').textContent = heightMatch[1].trim();
      if (thunderMatch) document.getElementById('s-thunder').textContent = thunderMatch[1];
      document.getElementById('s-water-temperature').textContent = waterTemp;
      if (uvMatch)      document.getElementById('s-uv').textContent     = uvMatch[1];
      if (srMatch)      document.getElementById('s-sunrise').textContent= srMatch[1];
      if (ssMatch)      document.getElementById('s-sunset').textContent = ssMatch[1];
    })
    .catch(err => console.error(err));
  </script>

  <!-- Slideshow (unchanged) -->
  <script>
  (function() {
    // ‚Ä¶ your existing slideshow code ‚Ä¶
  })();
  </script>
</body>
</html>
