<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>üå§Ô∏è NWS Daily Weather Maps & Radar</title>

  <!-- Weather Icons -->
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/weather-icons/2.0.10/css/weather-icons.min.css">
  <!-- Font Awesome (only for other icons) -->
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">

  <style>
    body { background: #f0f8ff; font-family: "Segoe UI", sans-serif; color: #333; text-align: center; padding: 2rem 1rem; }
    h1 { margin: 0; font-size: 2rem; color: #0277bd; }
    h2.subtitle { margin: .2rem 0 1.5rem; font-size: 1.2rem; color: #555; font-style: italic; }

    #alert-banner { display: none; background: #ffcccc; color: #900; padding: .75rem 1rem; margin-bottom: 1rem;
                    border: 1px solid #f00; border-radius: 4px; text-align: left; white-space: pre-wrap; font-size: .9rem; }

    /* Current Weather */
    #weather-summary { max-width: 800px; margin: 1.5rem auto; padding: 1.5rem;
                       background: #81d4fa; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.15); color: #fff; }
    #weather-summary h2 { margin-bottom: .2rem; font-size: 1.6rem; color: #0d47a1; }
    #weather-summary h3, #weather-summary h4 { margin: .1rem 0 .8rem; font-size: 1rem; color: rgba(255,255,255,0.85); font-style: italic; }
    .weather-card { display: grid; grid-template-columns: repeat(5,1fr); gap: 1rem; margin-top: 1rem; }
    .weather-item { background: rgba(0,0,0,0.4); border-radius: 6px; padding: 1rem; text-align: center; }
    .weather-item i { font-size: 2rem; margin-bottom: .3rem; color: #ffd54f; }
    .weather-item .label { display: block; font-size: .8rem; opacity: .8; }
    .weather-item .value { font-size: 1rem; font-weight: bold; }
    .weather-item .subvalue { display: block; font-size: .7rem; opacity: .7; margin-top: .5rem; }

    /* Sparkline */
    .sparkline { width: 100px; height: 30px; margin: .5rem auto; background: transparent; }

    /* Surf Forecast */
    #surf-forecast { max-width: 800px; margin: 1.5rem auto; padding: 1rem;
                     background: #ffffffcc; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); text-align: left; color: #333; }
    #surf-forecast h2 { margin-bottom: .2rem; font-size: 1.4rem; color: #0277bd; }
    #surf-forecast h3.subsubtitle { margin: .1rem 0 .6rem; font-size: 1rem; color: #555; font-style: italic; }

    .surf-forecast-container { display: flex; align-items: center; margin-top: 1rem; }
    .surf-forecast-container img { width: 120px; margin-right: 1rem; border: 2px solid #0277bd; border-radius: 8px; }
    .surf-info { flex: 1; }
    .surf-item { display: flex; align-items: center; margin: .5rem 0; font-size: .9rem; }
    .surf-item i { font-size: 1rem; margin-right: .5rem; color: #0277bd; }
    .surf-item .label { font-weight: bold; margin-right: .5rem; }
    .surf-item .value { margin-right: .5rem; }

    .uv-pill { display: inline-block; padding: .2rem .6rem; border-radius: 4px; color: #fff; font-weight: bold; font-size: .9rem; }

    /* Tide Times */
    #tide-times { max-width: 800px; margin: 1.5rem auto; padding: 1rem;
                  background: #ffffffcc; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); text-align: left; color: #333; }
    #tide-times h2 { font-size: 1.4rem; color: #0277bd; }
    #tide-times p { margin: .3rem 0; font-size: .9rem; }

    /* Plan Your Day */
    #plan-tip { max-width: 800px; margin: 1rem auto; padding: 1rem;
                background: #e8f4fd; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);
                color: #0277bd; font-size: 1rem; font-style: italic; }

    /* Rip Current Flag Guide */
    #flag-guide { max-width: 800px; margin: 1.5rem auto; padding: 1rem;
                   background: #ffffffcc; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);
                   text-align: left; color: #333; }
    #flag-guide h2 { font-size: 1.4rem; color: #0277bd; }
    #flag-guide p { margin: .5rem 0; font-size: .9rem; }

    /* Slideshow */
    .slideshow { position: relative; max-width: 800px; margin: 2rem auto;
                 border: 4px solid #81d4fa; border-radius: 12px; overflow: hidden;
                 box-shadow: 0 6px 18px rgba(0,0,0,0.15); background: white; height: 450px; }
    .slideshow img { position: absolute; top:0; left:0; width:100%; height:100%;
                     object-fit: contain; opacity:0; transition:opacity 1s ease-in-out; }
    .slideshow img.active { opacity:1; z-index:1; }

    #data-caption { font-size: .8rem; color: #666; margin-top: 1.5rem; }
  </style>
</head>
<body>
  <h1>‚òÄÔ∏è Daily Weather Forecast</h1>
  <h2 class="subtitle">Melbourne, FL</h2>

  <div id="alert-banner"></div>

  <section id="weather-summary">
    <h2>Current Weather</h2>
    <h3>Date: <span id="current-date">--/--/----</span></h3>
    <h4>Last updated: <span id="last-updated">--:--</span></h4>
    <div class="weather-card">
      <!-- temp, humidity, rain, wind, forecast -->
      <!-- identical to before... -->
    </div>
  </section>

  <section id="surf-forecast">
    <h2>Surf Forecast</h2>
    <h3 class="subsubtitle">Melbourne Beach</h3>
    <div class="surf-forecast-container">
      <!-- large flag PNG -->
      <img id="s-risk-img-large" src="images/flags/green.flag.png" alt="Rip Current Risk Flag">
      <div class="surf-info">
        <div class="surf-item">
          <i class="fas fa-water"></i>
          <span class="label">Rip Current Risk:</span>
          <span class="value" id="s-risk">--</span>
        </div>
        <div class="surf-item">
          <i class="wi wi-tsunami"></i>
          <span class="label">Surf Height:</span>
          <span class="value" id="s-height">--</span>
        </div>
        <div class="surf-item">
          <i class="wi wi-storm-showers"></i>
          <span class="label">Thunderstorm Potential:</span>
          <span class="value" id="s-thunder">--</span>
        </div>
        <div class="surf-item">
          <i class="wi wi-day-sunny"></i>
          <span class="label">UV Index:</span>
          <span id="s-uv-pill" class="uv-pill">--</span>
        </div>
        <div class="surf-item">
          <i class="wi wi-sunrise"></i>
          <span class="label">Sunrise:</span>
          <span class="value" id="s-sunrise">--:--</span>
        </div>
        <div class="surf-item">
          <i class="wi wi-sunset"></i>
          <span class="label">Sunset:</span>
          <span class="value" id="s-sunset">--:--</span>
        </div>
      </div>
    </div>
  </section>

  <section id="tide-times">
    <h2>Tide Times</h2>
    <p id="tide-port">Port Canaveral: --</p>
    <p id="tide-seb">Sebastian Inlet: --</p>
  </section>

  <div id="plan-tip">Tip of the day: Loading‚Ä¶</div>

  <section id="flag-guide">
    <h2>Rip Current Flag Guide</h2>
    <!-- guide items -->
  </section>

  <div class="slideshow"></div>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const now = new Date();
      document.getElementById('current-date').textContent =
        `${now.getMonth()+1}/${now.getDate()}/${now.getFullYear()}`;
      document.getElementById('last-updated').textContent =
        now.toLocaleTimeString([], { hour:'2-digit', minute:'2-digit' });
    });

    fetch('data/melbourne_fl_summary.txt')
      .then(r=>r.ok?r.text():Promise.reject())
      .then(txt=>{
        const L=txt.split('\n');

        // Alert banner, current weather, sparkline...
        // [unchanged from previous]

        // Surf + flag logic
        const surfS=L.findIndex(l=>l.includes('Barrier Islands')),
              surfE=L.findIndex((l,i)=>i>surfS&&l.includes('Sunset')),
              S=L.slice(surfS,surfE+1),
              ripL=S.find(l=>l.startsWith('Rip Current Risk')),
              surfL=S.find(l=>l.startsWith('Surf Height')),
              thL=S.find(l=>l.includes('Thunderstorm Potential')),
              uvL=S.find(l=>l.startsWith('UV Index')),
              srL=S.find(l=>l.includes('Sunrise')),
              ssL=S.find(l=>l.includes('Sunset'));

        const ripM=ripL.match(/Rip Current Risk.*?([A-Za-z ]+)/),
              surfM=surfL.match(/Around\s*([\d\s\w]+)/),
              thM=thL.match(/Thunderstorm Potential.*?([A-Za-z]+)/),
              srM=srL.match(/Sunrise.*?(\d{1,2}:\d{2}\s?(?:AM|PM))/),
              ssM=ssL.match(/Sunset.*?(\d{1,2}:\d{2}\s?(?:AM|PM))/);

        const thunderMap={Low:'Low chance',Moderate:'Moderate chance',High:'Very likely'},
              uvColor={Low:'#00FF00',Moderate:'#FFFF00',High:'#FF0000','Very High':'#FF4500'};

        const iconMap={
          Low:'green.flag.png',
          Moderate:'yellow.flag.png',
          High:'red.flag.png',
          Extreme:'doublered.flag.png',
          'Dangerous Marine Life':'purple.flag.png'
        };

        if(ripM){
          const lvl=ripM[1].trim();
          document.getElementById('s-risk').textContent=lvl;
          document.getElementById('s-risk-img-large').src = 'images/flags/'+(iconMap[lvl]||iconMap.Low);
        }
        if(surfM) document.getElementById('s-height').textContent=surfM[1].trim();
        if(thM)   document.getElementById('s-thunder').textContent=thunderMap[thM[1]]||thM[1];

        // UV
        const uvMatch=(uvL.match(/UV Index.*?([A-Za-z ]+)/)||[])[1];
        if(uvMatch){
          const pill=document.getElementById('s-uv-pill');
          pill.textContent=uvMatch;
          pill.style.background=uvColor[uvMatch]||'#999';
        }
        if(srM) document.getElementById('s-sunrise').textContent=srM[1];
        if(ssM) document.getElementById('s-sunset').textContent=ssM[1];

        // Tide times & Plan-your-day...
        // [unchanged from previous]

      })
      .catch(console.error);

    // Slideshow logic...
  </script>

  <div id="data-caption">Data extracted from the National Weather Service (NWS).</div>
</body>
</html>

